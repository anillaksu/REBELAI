#!/bin/bash
# Tek satÄ±r REBEL AI rapor analizi
ZIP="$1"; [[ -z "$ZIP" ]] && { echo "âŒ KullanÄ±m: $0 <report.zip>"; exit 1; }; [[ ! -f "$ZIP" ]] && { echo "âŒ Zip bulunamadÄ±: $ZIP"; exit 1; }; echo "ğŸ“¦ $ZIP analiz ediliyor..."; TMP=$(mktemp -d); unzip -q "$ZIP" -d "$TMP"; RPT=$(find "$TMP" -name "REBEL_AI_Report_*" -type d | head -1); [[ -z "$RPT" ]] && { echo "âŒ Rapor dizini bulunamadÄ±"; rm -rf "$TMP"; exit 1; }; echo -e "\nğŸš€ REBEL AI RAPOR ANALÄ°ZÄ° - $(basename "$RPT")\n========================================"; echo -e "\nğŸ“‹ Ã–ZET RAPOR:"; [[ -f "$RPT/RAPOR_OZETI.txt" ]] && head -30 "$RPT/RAPOR_OZETI.txt" || echo "Ã–zet yok"; echo -e "\nğŸ’» SÄ°STEM BÄ°LGÄ°SÄ°:"; [[ -f "$RPT/system/system_info.txt" ]] && head -20 "$RPT/system/system_info.txt" | grep -E "Hostname|OS|CPU|Memory" || echo "Sistem bilgisi yok"; echo -e "\nğŸ§  AI DATABASE:"; [[ -f "$RPT/data/knowledge.json" ]] && { SIZE=$(stat -c%s "$RPT/data/knowledge.json" 2>/dev/null | numfmt --to=iec || echo "?"); echo "ğŸ“Š Boyut: $SIZE"; command -v jq >/dev/null && { echo "ğŸ“ˆ Platforms: $(jq -r '.command_success_rates | keys | length' "$RPT/data/knowledge.json" 2>/dev/null || echo "?")"; echo "ğŸ¯ Device Profiles: $(jq -r '.device_profiles | keys | length' "$RPT/data/knowledge.json" 2>/dev/null || echo "?")"; } || echo "jq yok, JSON parse edilemedi"; } || echo "AI database yok"; echo -e "\nğŸ“œ KOMUT GEÃ‡MÄ°ÅÄ°:"; [[ -f "$RPT/logs/commands.log" ]] && { CMDS=$(wc -l < "$RPT/logs/commands.log"); echo "ğŸ“Š Toplam komut: $CMDS"; echo "ğŸ• Son 5 komut:"; tail -5 "$RPT/logs/commands.log" | cut -c1-80; } || echo "Komut geÃ§miÅŸi yok"; echo -e "\nğŸ› HATA ANALÄ°ZÄ°:"; ERR=0; [[ -d "$RPT/logs" ]] && for f in "$RPT/logs"/*.log; do [[ -f "$f" ]] && E=$(grep -c -i "error\|failed" "$f" 2>/dev/null || echo 0) && [[ $E -gt 0 ]] && { echo "âŒ $(basename "$f"): $E hata"; ERR=$((ERR+E)); }; done; [[ $ERR -eq 0 ]] && echo "âœ… Hata yok!" || echo "âš ï¸ Toplam $ERR hata"; echo -e "\nâš¡ API DURUMU:"; [[ -f "$RPT/current_status.txt" ]] && grep -E "Server.*responding|status" "$RPT/current_status.txt" | head -3 || echo "API durum bilgisi yok"; HEALTH=0; [[ -f "$RPT/RAPOR_OZETI.txt" ]] && HEALTH=$((HEALTH+1)); [[ -f "$RPT/data/knowledge.json" ]] && HEALTH=$((HEALTH+1)); [[ -f "$RPT/logs/commands.log" ]] && HEALTH=$((HEALTH+1)); [[ -f "$RPT/system/system_info.txt" ]] && HEALTH=$((HEALTH+1)); HP=$((HEALTH*25)); echo -e "\nğŸ“Š SAÄLIK SKORU: %$HP"; [[ $HP -ge 75 ]] && echo "ğŸ‰ MÃ¼kemmel!" || [[ $HP -ge 50 ]] && echo "ğŸ‘ Ä°yi" || echo "âš ï¸ Sorunlu"; echo -e "\n========================================"; echo "âœ… Analiz tamamlandÄ±!"; rm -rf "$TMP"